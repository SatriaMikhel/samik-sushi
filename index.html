<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Samik Sushi - Digital Menu</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        :root {
            --primary: #C62828; /* Merah Bendera Jepang */
            --primary-dark: #8E0000;
            --bg: #F2F4F7;
            --surface: #FFFFFF;
            --text-main: #1D1D1F;
            --text-sec: #86868B;
            --border: #E5E5EA;
            --shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg); color: var(--text-main); padding-bottom: 120px; }

        /* --- HEADER & HERO --- */
        header {
            background: var(--surface);
            padding: 15px 20px;
            position: sticky; top: 0; z-index: 90;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 1px 0 var(--border);
        }

        .brand-col h1 { font-size: 1.1rem; font-weight: 700; color: var(--primary); letter-spacing: -0.5px; }
        .brand-col p { font-size: 0.75rem; color: var(--text-sec); }
        
        .table-indicator {
            background: var(--bg); padding: 6px 12px; border-radius: 50px;
            font-size: 0.75rem; font-weight: 600; color: var(--text-main);
            border: 1px solid var(--border);
        }

        /* Hero Banner */
        .hero {
            margin: 20px; height: 140px; border-radius: 16px;
            background: linear-gradient(to right, #C62828, #FF5252);
            color: white; display: flex; flex-direction: column; justify-content: center; padding: 20px;
            position: relative; overflow: hidden;
            box-shadow: var(--shadow);
        }
        .hero h2 { font-size: 1.4rem; font-weight: 800; width: 70%; z-index: 2; }
        .hero p { font-size: 0.85rem; opacity: 0.9; margin-top: 5px; z-index: 2; }
        .hero img {
            position: absolute; right: -20px; bottom: -20px; width: 140px; opacity: 0.8; z-index: 1;
            transform: rotate(-15deg);
        }

        /* --- CONTROLS (Search & Filter) --- */
        .controls-sticky {
            position: sticky; top: 60px; z-index: 89; background: var(--bg);
            padding: 0 0 10px 0;
        }

        .search-box {
            margin: 0 20px 15px 20px;
            background: var(--surface); border-radius: 12px;
            padding: 10px 15px; display: flex; align-items: center; gap: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.03); border: 1px solid var(--border);
        }
        .search-box input {
            border: none; outline: none; width: 100%; font-size: 0.95rem; color: var(--text-main);
        }

        .categories {
            padding: 0 20px; display: flex; gap: 10px; overflow-x: auto; scrollbar-width: none;
        }
        .categories::-webkit-scrollbar { display: none; }
        
        .cat-pill {
            padding: 8px 16px; background: var(--surface); border-radius: 50px;
            font-size: 0.85rem; font-weight: 500; color: var(--text-sec);
            white-space: nowrap; cursor: pointer; border: 1px solid transparent;
            transition: 0.2s;
        }
        .cat-pill.active {
            background: var(--text-main); color: white; font-weight: 600;
        }

        /* --- MENU LIST --- */
        .menu-list { padding: 20px; display: flex; flex-direction: column; gap: 20px; }
        
        .menu-card {
            background: var(--surface); border-radius: 16px; padding: 12px;
            display: flex; gap: 15px; position: relative;
        }
        .menu-card.sold-out { opacity: 0.6; grayscale: 100%; pointer-events: none; }
        
        .thumb {
            width: 90px; height: 90px; background: #eee; border-radius: 12px; object-fit: cover;
        }
        .badge-sold {
            position: absolute; top: 12px; left: 12px; background: #333; color: white;
            font-size: 0.6rem; padding: 4px 8px; border-radius: 8px 0 8px 0; font-weight: 700;
            z-index: 10; display: none;
        }
        .menu-card.sold-out .badge-sold { display: block; }

        .info { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .m-title { font-weight: 600; font-size: 1rem; margin-bottom: 4px; }
        .m-desc { font-size: 0.75rem; color: var(--text-sec); line-height: 1.4; }
        
        .m-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        .price { font-weight: 700; color: var(--primary); }
        
        .add-btn {
            width: 32px; height: 32px; border-radius: 50%; border: none;
            background: var(--bg); color: var(--primary);
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; cursor: pointer; transition: 0.2s;
        }
        .add-btn:active { background: var(--primary); color: white; transform: scale(0.9); }

        /* --- FLOATING ACTIONS --- */
        .bottom-nav {
            position: fixed; bottom: 0; width: 100%; background: var(--surface);
            padding: 15px 20px 25px 20px; border-radius: 24px 24px 0 0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05); z-index: 95;
            display: flex; gap: 10px;
        }

        .btn-staff {
            width: 50px; height: 50px; border-radius: 14px; background: #FFF0F0;
            color: var(--primary); display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; cursor: pointer; flex-shrink: 0; border: 1px solid #FFCDD2;
        }

        .btn-cart {
            flex: 1; background: var(--text-main); color: white;
            border-radius: 14px; display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; cursor: pointer; font-weight: 600;
        }
        .btn-cart.disabled { opacity: 0.5; pointer-events: none; }

        /* --- MODAL SHEET --- */
        .sheet-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(2px);
            z-index: 100; opacity: 0; pointer-events: none; transition: 0.3s;
        }
        .sheet-overlay.active { opacity: 1; pointer-events: all; }

        .sheet-content {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: var(--surface); border-radius: 24px 24px 0 0;
            padding: 25px; transform: translateY(100%); transition: 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            z-index: 101; max-height: 90vh; display: flex; flex-direction: column;
        }
        .sheet-content.active { transform: translateY(0); }

        .order-list { overflow-y: auto; margin: 20px 0; padding-right: 5px; }
        .order-item { display: flex; justify-content: space-between; margin-bottom: 15px; align-items: flex-start; }
        .qty-badge { background: var(--bg); padding: 2px 8px; border-radius: 6px; font-weight: 600; font-size: 0.85rem; margin-right: 8px; }
        
        .note-input {
            width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--border);
            font-size: 0.85rem; margin-top: 10px; background: var(--bg); outline: none;
        }

        /* --- TOAST NOTIFICATION --- */
        .toast {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
            background: #333; color: white; padding: 10px 20px; border-radius: 50px;
            font-size: 0.85rem; font-weight: 500; z-index: 200; transition: 0.4s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 8px;
        }
        .toast.show { transform: translateX(-50%) translateY(0); }

    </style>
</head>
<body>

    <div class="toast" id="toastMsg">
        <i class="ph-fill ph-check-circle" style="color: #4CAF50;"></i>
        <span id="toastText">Berhasil ditambahkan</span>
    </div>

    <header>
        <div class="brand-col">
            <h1>SAMIK SUSHI</h1>
            <p>Jln. Merdeka No. 45</p>
        </div>
        <div class="table-indicator" id="tableIndicator">
            <i class="ph-bold ph-scan"></i> Scan QR
        </div>
    </header>

    <div class="hero">
        <h2>Authentic<br>Japanese Taste</h2>
        <p>Diskon 20% untuk Salmon Series!</p>
        <img src="https://cdn-icons-png.flaticon.com/512/2252/2252075.png" alt="Sushi Art">
    </div>

    <div class="controls-sticky">
        <div class="search-box">
            <i class="ph-bold ph-magnifying-glass" style="color: var(--text-sec);"></i>
            <input type="text" id="searchInput" placeholder="Cari menu (misal: Salmon)..." oninput="doSearch()">
        </div>

        <div class="categories">
            <div class="cat-pill active" onclick="filterCat('all', this)">Semua</div>
            <div class="cat-pill" onclick="filterCat('sushi', this)">Sushi</div>
            <div class="cat-pill" onclick="filterCat('ramen', this)">Ramen</div>
            <div class="cat-pill" onclick="filterCat('drink', this)">Minuman</div>
        </div>
    </div>

    <div class="menu-list" id="menuList">
        </div>

    <div class="bottom-nav">
        <div class="btn-staff" onclick="callStaff()">
            <i class="ph-fill ph-bell"></i>
        </div>
        <div class="btn-cart disabled" id="btnCart" onclick="openCart()">
            <span><span id="totalItems">0</span> Item</span>
            <span>Total: <span id="totalPrice">Rp 0</span></span>
        </div>
    </div>

    <div class="sheet-overlay" id="overlay" onclick="closeCart()"></div>
    <div class="sheet-content" id="cartSheet">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2 style="font-size: 1.2rem;">Konfirmasi Pesanan</h2>
            <i class="ph-bold ph-x" style="font-size: 1.5rem; cursor: pointer;" onclick="closeCart()"></i>
        </div>
        
        <div class="order-list" id="cartItemsRender">
            </div>

        <div>
            <small style="font-weight: 600; margin-bottom: 5px; display: block;">Catatan Tambahan (Opsional)</small>
            <textarea class="note-input" id="orderNote" rows="2" placeholder="Contoh: Jangan pakai daun bawang, minta mangkuk kecil..."></textarea>
        </div>

        <div style="margin-top: 20px; border-top: 1px dashed var(--border); padding-top: 15px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                <span style="color: var(--text-sec);">Subtotal</span>
                <span id="summarySubtotal">Rp 0</span>
            </div>
            <div style="display: flex; justify-content: space-between; font-weight: 700; font-size: 1.1rem;">
                <span>Total Bayar</span>
                <span id="summaryTotal" style="color: var(--primary);">Rp 0</span>
            </div>
        </div>

        <button style="margin-top: 20px; width: 100%; background: var(--primary); color: white; border: none; padding: 16px; border-radius: 14px; font-weight: 600; font-size: 1rem;" onclick="submitOrder()">
            Kirim ke Dapur
        </button>
    </div>

    <script>
        // --- DATA ---
        // Simulasi: Salmon Mentai Sold Out
        const products = [
            { id: 1, name: "Salmon Mentai", cat: "sushi", price: 45000, desc: "Salmon bakar saus mentai", img: "https://images.unsplash.com/photo-1635527023946-9b7338548716?auto=format&fit=crop&w=200&q=80", soldOut: true },
            { id: 2, name: "Tuna Nigiri", cat: "sushi", price: 30000, desc: "Nasi kepal tuna segar", img: "https://images.unsplash.com/photo-1553621042-f6e147245754?auto=format&fit=crop&w=200&q=80", soldOut: false },
            { id: 3, name: "Volcano Roll", cat: "sushi", price: 55000, desc: "Spicy salmon roll goreng", img: "https://images.unsplash.com/photo-1617196034438-4e7d70247691?auto=format&fit=crop&w=200&q=80", soldOut: false },
            { id: 4, name: "Miso Ramen", cat: "ramen", price: 38000, desc: "Kuah tauco Jepang ayam", img: "https://images.unsplash.com/photo-1591814468924-4428adc105ce?auto=format&fit=crop&w=200&q=80", soldOut: false },
            { id: 5, name: "Gyoza Ayam", cat: "ramen", price: 25000, desc: "5 pcs pangsit goreng", img: "https://images.unsplash.com/photo-1626805164842-517125664e21?auto=format&fit=crop&w=200&q=80", soldOut: false },
            { id: 6, name: "Ice Ocha", cat: "drink", price: 12000, desc: "Teh hijau tawar (Refill)", img: "https://images.unsplash.com/photo-1625772452859-1c03d5bf1137?auto=format&fit=crop&w=200&q=80", soldOut: false },
        ];

        let cart = {};
        let currentTable = null;

        // --- INIT ---
        window.onload = function() {
            checkTableParam();
            renderMenu(products);
        };

        function checkTableParam() {
            const urlParams = new URLSearchParams(window.location.search);
            const table = urlParams.get('meja');
            const indicator = document.getElementById('tableIndicator');
            
            if(table) {
                currentTable = table;
                indicator.innerHTML = `<i class="ph-fill ph-chair"></i> MEJA ${table}`;
                indicator.style.background = "#E8F5E9";
                indicator.style.color = "#2E7D32";
                indicator.style.borderColor = "#2E7D32";
            } else {
                indicator.innerHTML = `<i class="ph-bold ph-warning"></i> Scan QR`;
                indicator.style.background = "#FFF3E0";
                indicator.style.color = "#E65100";
            }
        }

        // --- RENDERING ---
        function renderMenu(data) {
            const list = document.getElementById('menuList');
            list.innerHTML = '';

            if(data.length === 0) {
                list.innerHTML = '<div style="text-align:center; color:#888; padding:20px;">Menu tidak ditemukan</div>';
                return;
            }

            data.forEach(item => {
                const soldClass = item.soldOut ? 'sold-out' : '';
                const btnHtml = item.soldOut 
                    ? `<span style="font-size:0.75rem; font-weight:600; color:#888;">HABIS</span>` 
                    : `<button class="add-btn" onclick="addToCart(${item.id})"><i class="ph-bold ph-plus"></i></button>`;

                list.innerHTML += `
                    <div class="menu-card ${soldClass}">
                        <div class="badge-sold">SOLD OUT</div>
                        <img src="${item.img}" class="thumb" alt="${item.name}">
                        <div class="info">
                            <div>
                                <div class="m-title">${item.name}</div>
                                <div class="m-desc">${item.desc}</div>
                            </div>
                            <div class="m-footer">
                                <div class="price">Rp ${item.price.toLocaleString()}</div>
                                ${btnHtml}
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        // --- LOGIC ---
        function filterCat(cat, el) {
            document.querySelectorAll('.cat-pill').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            
            const filtered = cat === 'all' ? products : products.filter(p => p.cat === cat);
            renderMenu(filtered);
        }

        function doSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const filtered = products.filter(p => p.name.toLowerCase().includes(query));
            renderMenu(filtered);
        }

        function addToCart(id) {
            if(!cart[id]) cart[id] = 0;
            cart[id]++;
            updateCartUI();
            showToast("Masuk keranjang");
        }

        function updateCartUI() {
            let totalItems = 0;
            let totalPrice = 0;
            const cartRender = document.getElementById('cartItemsRender');
            cartRender.innerHTML = '';

            for(const [id, qty] of Object.entries(cart)) {
                const item = products.find(p => p.id == id);
                totalItems += qty;
                totalPrice += (item.price * qty);

                cartRender.innerHTML += `
                    <div class="order-item">
                        <div style="display:flex; align-items:center;">
                            <span class="qty-badge">${qty}x</span>
                            <div>
                                <div style="font-weight:600; font-size:0.9rem;">${item.name}</div>
                                <div style="font-size:0.75rem; color:#777;">@ Rp ${item.price.toLocaleString()}</div>
                            </div>
                        </div>
                        <div style="font-weight:600;">Rp ${(item.price * qty).toLocaleString()}</div>
                    </div>
                `;
            }

            document.getElementById('totalItems').innerText = totalItems;
            document.getElementById('totalPrice').innerText = 'Rp ' + totalPrice.toLocaleString();
            document.getElementById('summarySubtotal').innerText = 'Rp ' + totalPrice.toLocaleString();
            
            // Tambah pajak 10%
            const totalBayar = totalPrice * 1.1;
            document.getElementById('summaryTotal').innerText = 'Rp ' + totalBayar.toLocaleString(undefined, {maximumFractionDigits: 0});

            const btn = document.getElementById('btnCart');
            if(totalItems > 0) {
                btn.classList.remove('disabled');
                btn.style.background = "var(--text-main)";
            } else {
                btn.classList.add('disabled');
            }
        }

        // --- ACTIONS ---
        function openCart() {
            if(document.getElementById('totalItems').innerText == '0') return;
            document.getElementById('overlay').classList.add('active');
            document.getElementById('cartSheet').classList.add('active');
        }

        function closeCart() {
            document.getElementById('overlay').classList.remove('active');
            document.getElementById('cartSheet').classList.remove('active');
        }

        function showToast(msg) {
            const toast = document.getElementById('toastMsg');
            document.getElementById('toastText').innerText = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function callStaff() {
            if(!currentTable) {
                alert("Mohon Scan QR Code Meja terlebih dahulu!");
                return;
            }
            // Simulasi panggil staff
            showToast("Pelayan sedang menuju Meja " + currentTable);
        }

        function submitOrder() {
            if(!currentTable) {
                alert("Error: Lokasi meja tidak terdeteksi. Mohon scan ulang QR Code.");
                return;
            }
            const note = document.getElementById('orderNote').value;
            // Di sini logika kirim ke server
            
            closeCart();
            setTimeout(() => {
                alert(`Pesanan Meja ${currentTable} Diterima!\nCatatan: ${note ? note : '-'}`);
                cart = {}; // Reset
                updateCartUI();
                document.getElementById('orderNote').value = '';
            }, 500);
        }
    </script>
</body>
</html>
